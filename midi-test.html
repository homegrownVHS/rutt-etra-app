<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MIDI Inspector</title>
</head>
<body>
  <h2>nanoKONTROL2 MIDI Inspector</h2>
  <p>Move each fader, knob, and button.<br>
     <b>See all MIDI CCs here, labeled as you go!</b></p>
  <pre id="log" style="background:#111;color:#0f0;padding:1em;max-height:500px;overflow:auto;"></pre>
  <script>
    let lastCCs = {};
    if (navigator.requestMIDIAccess) {
      navigator.requestMIDIAccess().then(midiAccess => {
        for (let input of midiAccess.inputs.values()) {
          input.onmidimessage = function (msg) {
            let [status, cc, val] = msg.data;
            let type = (status & 0xF0) === 0xB0 ? 'CC' : 'Other';
            let isNew = (lastCCs[cc] !== val);
            lastCCs[cc] = val;
            let msgText = `CC${cc} = ${val}`;
            if (isNew) {
              let line = `[${new Date().toLocaleTimeString()}] ${msgText}`;
              document.getElementById('log').textContent += line + "\n";
            }
          };
        }
      });
    } else {
      document.getElementById('log').textContent = "Web MIDI API not supported.";
    }
  </script>
</body>
</html>
